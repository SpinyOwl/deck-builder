<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.web.WebView?>
<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.spinyowl.cards.controller.DeckBuilderController">
    <top>
        <ToolBar>
            <Button text="Reload" onAction="#onReload"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button text="&#x2715;" onAction="#onCloseProject" focusTraversable="false"
                    style="-fx-background-color: transparent; -fx-border-color: transparent; -fx-focus-color: transparent;">
                <tooltip>
                    <Tooltip text="Close Project"/>
                </tooltip>
            </Button>
        </ToolBar>
    </top>
    <center>
        <!-- Make console resizable by placing it in a vertical SplitPane with the main content -->
        <SplitPane fx:id="mainVerticalSplit" orientation="VERTICAL" dividerPositions="0.8">
            <!-- Top area: host toolbar and project preview in a BorderPane -->
            <BorderPane>
                <left>
                    <ToolBar orientation="VERTICAL" prefWidth="30">
                        <ToggleButton fx:id="projectTreeToggle" text="ðŸ“" selected="true"
                                      onAction="#onToggleProjectTree" prefWidth="30">
                            <tooltip>
                                <Tooltip text="Toggle project tree"/>
                            </tooltip>
                        </ToggleButton>
                    </ToolBar>
                </left>
                <center>
                    <SplitPane fx:id="mainHorizontalSplit" dividerPositions="0.25,0.75">
                        <StackPane fx:id="projectTreeContainer">
                            <TreeView fx:id="projectTree" minWidth="50" prefWidth="260"/>
                        </StackPane>
                        <StackPane fx:id="middleContentContainer"/>
                        <StackPane fx:id="previewPane">
                            <BorderPane fx:id="previewContainer">
                                <center>
                                    <BorderPane style="-fx-padding: 5px;">
                                        <center>
                                            <WebView fx:id="webView"/>
                                        </center>
                                    </BorderPane>
                                </center>
                                <bottom>
                                    <ToolBar StackPane.alignment="BOTTOM_CENTER"
                                             styleClass="preview-toolbar"
                                             focusTraversable="false">
                                        <StackPane.margin>
                                            <Insets top="10" right="10"/>
                                        </StackPane.margin>
                                        <Label text="Language:"/>
                                        <ComboBox fx:id="langBox" prefWidth="100"/>
                                        <Label text="Index:"/>
                                        <Spinner fx:id="indexSpinner" prefWidth="80" editable="true"/>
                                        <Button text="Show" onAction="#onShow"/>
                                        <Separator orientation="VERTICAL"/>
                                        <Button text="-" onAction="#onZoomOut" focusTraversable="false">
                                            <tooltip>
                                                <Tooltip text="Zoom out"/>
                                            </tooltip>
                                        </Button>
                                        <Button text="+" onAction="#onZoomIn" focusTraversable="false">
                                            <tooltip>
                                                <Tooltip text="Zoom in"/>
                                            </tooltip>
                                        </Button>
                                        <Button text="Reset" onAction="#onZoomReset"
                                                focusTraversable="false">
                                            <tooltip>
                                                <Tooltip text="Reset zoom"/>
                                            </tooltip>
                                        </Button>
                                        <ToggleButton fx:id="zoomFitToggle" text="Fit" onAction="#onZoomFit"
                                                      focusTraversable="false">
                                            <tooltip>
                                                <Tooltip text="Fit to size"/>
                                            </tooltip>
                                        </ToggleButton>
                                    </ToolBar>

                                </bottom>
                            </BorderPane>
                        </StackPane>
                    </SplitPane>
                </center>
                <right>
                    <ToolBar orientation="VERTICAL" prefWidth="30">
                        <ToggleButton fx:id="previewToggle" text="ðŸ‘" selected="true"
                                      onAction="#onTogglePreview" prefWidth="30">
                            <tooltip>
                                <Tooltip text="Toggle preview"/>
                            </tooltip>
                        </ToggleButton>
                    </ToolBar>
                </right>
            </BorderPane>
            <!-- Bottom area: console log, now resizable via the SplitPane divider -->
            <TitledPane fx:id="consolePane" text="Console Log" expanded="false" animated="false" maxHeight="Infinity">
                <TextArea fx:id="consoleTextArea" editable="false" wrapText="true" prefRowCount="5"
                          style="-fx-font-family: 'Consolas', 'Courier New', monospace;"/>
            </TitledPane>
        </SplitPane>
    </center>
</BorderPane>
